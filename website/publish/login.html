<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" type="text/css" href="style.css" />
		<link rel="stylesheet" type="text/css" href="css/el-index.css" />

		<script src="js/vue.js"></script>
		<script src="js/axios.min.js"></script>
		<script src="js/qs.min.js"></script>
		<script src="js/el-index.js"></script>
		<script src="js/vue-cookies.js"></script>
		<title></title>
		<style>
			.w-e-text-container{
			    height: 550px !important;/*!important是重点，因为原div是行内样式设置的高度300px*/
			}
			.progress{
				margin: auto;
			}
		</style>
	</head>
	<body>
		<div id="main" style="width: 20%;margin-left: 40%;margin-top: 15%;">
			<el-form ref="form" label-width="80px" :model="form">
				<el-form-item prop="account" label="账号" :rules="[{required: true,message:'账号不能为空'}]">
					<el-input v-model="form.account"></el-input>
				</el-form-item>
				<el-form-item prop="password" label="密码" :rules="[{required: true,message:'账号不能为空'}]">
					<el-input type="password" v-model="form.password"></el-input>
				</el-form-item>
				
				
				<el-form-item style="text-align: center;">
					<el-button type="primary" @click="login('form')" >登录</el-button>
				</el-form-item>
			</el-form>

		</div>
	</body>
</html>
<script>
	new Vue({
		el: "#main",
		data: {
			form:{
				account: '',
				password:''
			}	
		},
		methods: {
			login(formName) {
				
				this.$refs[formName].validate((valid) => {
				          if (valid) {
							  axios.get("http://8.129.27.254:8000/checkmanageruser?username="+this.form.account+"&pwd="+this.form.password
							  ).then((response)=>{
							  	console.log(response.data,this.form);
								if(response.data=="用户不存在"){
									this.$message.error("用户不存在")
								}else if(response.data=="密码错误"){
									this.$message.error("密码错误")
								}else{
									if(response.data=="1"){
										location.href="http://8.129.27.254/publish/editor.html"
									}else if(response.data=="0"){
										alert("管理员")
									}else{
										alert("非管理员或媒体朋友")
									}
									
								}
							  }).catch(function(error){
							  	console.log(error);
							  })
				          } else {
				            return false;
				          }
						})
				
			}
		}
	});
</script>
